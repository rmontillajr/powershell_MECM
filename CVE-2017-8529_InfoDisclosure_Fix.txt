# Set registry keys to address CVE-2017-8529
$regKeyPath1 = "HKLM:\SOFTWARE\WOW6432Node\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_ENABLE_PRINT_INFO_DISCLOSURE_FIX"
$regKeyPath2 = "HKLM:\SOFTWARE\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_ENABLE_PRINT_INFO_DISCLOSURE_FIX"

try {
    # Create registry keys
    New-Item -Path $regKeyPath1 -Force
    New-Item -Path $regKeyPath2 -Force

    # Create registry values
    New-ItemProperty -Path $regKeyPath1 -Name "iexplore.exe" -Value 1 -PropertyType DWORD -Force
    New-ItemProperty -Path $regKeyPath2 -Name "iexplore.exe" -Value 1 -PropertyType DWORD -Force

    # Output success message
    Write-Output "Registry keys set successfully."
    exit 0
}
catch {
    # Output error message
    Write-Output "Failed to set registry keys: $_"
    exit 1
}
